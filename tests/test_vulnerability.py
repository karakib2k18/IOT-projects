import pandas as pd
from pathlib import Path

def test_vulnerable_is_weak():
    root = Path(__file__).resolve().parents[1]
    s = pd.read_csv(root / "results" / "summary_vulnerable.csv").iloc[0]
    assert s["confidentiality_pct"] <= 10.0, "Baseline not vulnerable enough (conf too high)"
    assert s["intercepted"] >= 0.9 * s["total_msgs"], "Too few intercepted msgs"

print("âœ… test_vulnerability.py loaded")
